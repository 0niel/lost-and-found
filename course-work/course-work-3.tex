\section{Технологический раздел}
\label{sec:technology}

\subsection{Выбор технологий для реализации системы}

Были выбрали надежный и современный набор технологий для своего веб-сервиса «Бюро находок». Вот краткий обзор некоторых из наиболее важных технологий в вашем стеке и почему они полезны для проекта:

\begin{enumerate}
	\item Next.js
	
	Next.js~--- это мощная платформа React, которая обеспечивает рендеринг на стороне сервера и генерацию статических сайтов, что может помочь улучшить производительность и SEO веб-приложения. Он также поддерживает маршруты API, что упрощает внутреннюю разработку в рамках одного проекта.
	
	\item React (react, react-dom)
	
	React~--- популярная библиотека JavaScript для создания пользовательских интерфейсов, особенно одностраничных приложений, где требуется быстрый ответ на взаимодействие с пользователем. Это помогает в создании повторно используемых компонентов пользовательского интерфейса.
	
	\item tRPC (@trpc/client, @trpc/next, @trpc/react-query, @trpc/server)
	
	tRPC позволяет создавать типобезопасные API без необходимости писать схемы или генерировать типы. Он использует TypeScript, чтобы обеспечить проверку типов входных и выходных данных API, что снижает вероятность ошибок во время выполнения и повышает производительность разработчиков.
	
	\item Prisma (@prisma/client, @next-auth/prisma-adapter)
	
	Prisma~--- это ORM (реляционное сопоставление объектов), которое упрощает доступ к базе данных и обеспечивает безопасность типов. Адаптер Prisma для NextAuth.js упрощает создание надежных систем аутентификации, привязанных непосредственно к схеме вашей базы данных.
	
	\item NextAuth (next-auth)
	
	Это комплексное решение для аутентификации в приложениях Next.js. Он поддерживает различные стратегии входа в систему с минимальной настройкой, повышая безопасность приложения.
	
	\item React Query (@tanstack/react-query)
	
	React Query~--- это библиотека для эффективного извлечения, кэширования и обновления данных в приложениях React. Это помогает управлять состоянием сервера и синхронизировать пользовательский интерфейс с данными без использования бойлерплейт кода.
	
	\item Zustand (zustand)
	
	Zustand~--- это минималистичное решение для управления состоянием, которое работает «из коробки» с React. Это просто, быстро и не требует шаблонного кода, как это делают другие библиотеки управления состоянием.
	
	\item Tailwind CSS (черех flowbite and flowbite-react)
	
	Tailwind CSS~--- это ориентированная на утилиты CSS-инфраструктура, наполненная классами, которые можно создавать для создания любого дизайна прямо в вашей разметке. Flowbite расширяет Tailwind дополнительными компонентами, ускоряя создание красивых и отзывчивых интерфейсов.
	
	\item AWS SDK (aws-sdk)
	
	AWS SDK позволяет легко использовать веб-сервисы Amazon, такие как S3 для хранения, SES для отправки электронной почты и т. д., прямо из приложения. Это имеет решающее значение для масштабирования и управления инфраструктурой.
	
	\item Headless UI (@headlessui/react)
	
	Эта библиотека предоставляет полностью неоформленные, полностью доступные компоненты пользовательского интерфейса, предназначенные для прекрасной интеграции с Tailwind CSS. Это помогает в создании пользовательских и доступных выпадающих списков, модальных окон и т. д.
\end{enumerate}

\subsection{Реализация модулей автоматизации процессов}

\subsubsection{Модуль регистрации и авторизации пользователей}

Модуль представляет реализацию OAuth с единовременной передачей данных пользователя.

OAuth (Open Authorization)~--- это открытый стандарт авторизации, который позволяет пользователям предоставлять безопасный делегированный доступ к своим учетным записям на различных сервисах, не раскрывая свои пароли. Реализация клиента OAuth включает несколько ключевых этапов и может варьироваться в зависимости от используемой версии OAuth (например, OAuth 1.0 или OAuth 2.0). Страница логина представлена на~рис.~\ref{fig:login-page}.

\begin{figure}[htb]
	\centering
	\includegraphics[width=.95\textwidth]{images/login-page.png}
	\parskip=6pt
	\caption{Страница логина}
	\label{fig:login-page}
\end{figure}

Ниже описан процесс реализации клиента для OAuth 2.0.

\begin{enumerate}
	\item Регистрация приложения
	
	Перед тем как начать, вам нужно зарегистрировать ваше приложение на платформе, которую вы хотите использовать (например, Google, Facebook, GitHub). В процессе регистрации вам нужно будет указать:
	
	\begin{itemize}
		\item Название приложения
		\item URL, на который будет перенаправлен пользователь после авторизации (callback URL)
	\end{itemize}

	После регистрации вы получите client ID и client secret, которые будут использоваться для аутентификации вашего приложения.
	
	\item Получение кода авторизации
	
	Клиент должен перенаправить пользователя на URL авторизации, предоставленный сервисом, с необходимыми параметрами запроса:
	
	\begin{itemize}
		\item \textbf{response\_type} (обычно \textbf{code})
		\item \textbf{client\_id}
		\item \textbf{redirect\_uri}
		\item \textbf{scope} (необязательно, зависит от того, к каким данным приложение стремится получить доступ)
		\item \textbf{state} (рекомендуется для защиты от CSRF-атак)
	\end{itemize}
	
	Пользователь входит в систему (если еще не вошел) и подтверждает доступ к своим данным. После этого сервис перенаправляет пользователя обратно на \textbf{redirect\_uri} с кодом авторизации в параметрах URL.
	
	\item Обмен кода авторизации на токен доступа
	
	После получения кода авторизации, приложение делает запрос на сервер сервиса для обмена кода на токен доступа. Этот запрос должен содержать:
	
	\begin{itemize}
		\item \textbf{grant\_type} (обычно \textbf{authorization\_code})
		\item \textbf{code} (полученный код авторизации)
		\item \textbf{redirect\_uri}
		\item \textbf{client\_id}
		\item \textbf{client\_secret}
		
	\end{itemize}
	
	Если запрос успешен, сервер ответит JSON-объектом, содержащим \textbf{access\_token} (и возможно \textbf{refresh\_token} и другие данные).
	
	\item Использование токена доступа
	
	Токен доступа используется для доступа к защищенным ресурсам пользователя. Он добавляется в заголовок HTTP-запроса как \textbf{Authorization: Bearer <token>}.
	
	\item Обновление токена
	
	Если получен \textbf{refresh\_token}, его можно использовать для получения нового \textbf{access\_token} после его истечения без необходимости повторной аутентификации пользователя.
	
\end{enumerate}


\subsubsection{Модуль бесконечных лент объявлений потерянных, найденных вещей}

Для создания бесконечной ленты объявлений в React можно воспользоваться следующим подходом, основанным на базовых принципах React и встроенных возможностях JavaScript:

\begin{enumerate}
	\item Структура состояния
	
	Создается состояние в компоненте, которое будет хранить массив объявлений и переменную для отслеживания, загружены ли все данные.
	
	\item Загрузка данных
	
	Реализуется функция, которая будет загружать порции данных (например, по 10 объявлений за раз). Эта функция должна обновлять ваше состояние, добавляя новые объявления к уже загруженным.
	
	\item Отслеживание прокрутки
	
	Добавляется обработчик события прокрутки к элементу, в котором отображаются объявления. Когда пользователь достигает конца списка, вызывайте функцию загрузки данных.
	
	\item Условия для загрузки
	
	Необходимо убедиться, что новые данные загружаются только когда предыдущая загрузка завершена, чтобы избежать повторных запросов. Также нужно проверить, не достигнут ли конец списка данных, чтобы прекратить загрузку новых данных.
	
	\item Отображение данных
	
	Используется метод map для преобразования массива объявлений в JSX-элементы, которые будут отображаться в пользовательском интерфейсе.
	
	\item Оптимизация производительности
	
	Используется техники оптимизации, такие как React.memo для компонентов объявлений, чтобы избежать ненужных ререндеров при добавлении новых объявлений.
	
	\item Обработка ошибок
	
	Также нужно добавить обработку ошибок для ситуаций, когда загрузка данных может завершиться неудачей, например, при проблемах с сетью.
\end{enumerate}

Реализация бесконечной ленты объявлений представлена на рис. \ref{fig:infinity-scroll-page}.

\begin{figure}[htb]
	\centering
	\includegraphics[width=.95\textwidth]{images/infinity-scroll-page.png}
	\parskip=6pt
	\caption{Страница бесконечной ленты объявлений}
	\label{fig:infinity-scroll-page}
\end{figure}

\subsubsection{Модуль добавления и поиска утерянных вещей}

Для добавления утерянных вещей реализована форма с вводом названия, описания, возможностью загружать картинки в объектное хранилище. Форма представлена на рисунке \ref{fig:lost-item-from-page}.

\begin{figure}[htb]
	\centering
	\includegraphics[width=.95\textwidth]{images/lost-item-from-page.png}
	\parskip=6pt
	\caption{Форма ввода утерянных вещей}
	\label{fig:lost-item-from-page}
\end{figure}

Полнотекстовый поиск по названиям и описаниям происходит по названиям и описанию объявлений. Реализация клиентской части поиска представлена на рисунке \ref{fig:search-page}.

\begin{figure}[htb]
	\centering
	\includegraphics[width=.95\textwidth]{images/search-page.png}
	\parskip=6pt
	\caption{Форма ввода утерянных вещей}
	\label{fig:search-page}
\end{figure}

\subsection*{Вывод по разделу}

Были реализованы модули, необходимые для реализации приложения.